import { CANVAS_WIDTH, CANVAS_HEIGHT, Ghost, Protagonist } from "./init.js";
// the protagonist needs to avoid colliding with the ghosts
const protagonist = new Protagonist();
const Ghosts = [];
const MIN_GHOSTS = 50;
const MAX_GHOSTS = 250;
// adds ghosts to the canvas every 2 seconds
const spawnInterval = setInterval(() => {
    // create a new ghost if there are less than the max number of ghosts
    if (Ghosts.length < MAX_GHOSTS) {
        const newGhost = new Ghost();
        Ghosts.push(newGhost);
    }
    // decide whether to remove a random ghost
    const removeRandomGhost = [true, false][Math.floor(Math.random() * 2)];
    // remove a random ghost as well only if minimum number of ghosts is exceeded
    if (removeRandomGhost && Ghosts.length > MIN_GHOSTS) {
        const randomIndex = Math.floor(Math.random() * Ghosts.length);
        const ghostToRemove = Ghosts[randomIndex];
        ghostToRemove.entity.remove();
        Ghosts.splice(randomIndex, 1);
    }
    // change ghost directions
    Ghosts.forEach((ghost) => ghost.changeDirection());
}, 2000);
const moveInterval = setInterval(() => {
    // move all the ghosts
    Ghosts.forEach((ghost) => ghost.move());
    // check protagonist collision with ghosts
    Ghosts.forEach((ghost) => {
        if (protagonist.isCollidingWithGhost(ghost)) {
            console.log("Game Over!");
            clearInterval(spawnInterval);
            clearInterval(moveInterval);
            protagonist.entity.remove();
            Ghosts.forEach((ghost) => ghost.entity.remove());
            alert("W A S T E D !!!");
        }
    });
}, 100);
window.addEventListener("keydown", function (event) {
    if (["ArrowUp", "ArrowDown", "ArrowLeft", "ArrowRight"].includes(event.key)) {
        console.log(`x: ${protagonist.entity.x}, y: ${protagonist.entity.y}, width: ${protagonist.entity.width}, height: ${protagonist.entity.height}`);
    }
    const { topBoundPosn, bottomBoundPosn, leftBoundPosn, rightBoundPosn } = protagonist.entity;
    // up arrow
    if (event.key === "ArrowUp") {
        if (topBoundPosn > 0)
            protagonist.moveUp();
    }
    // down arrow
    if (event.key === "ArrowDown") {
        if (bottomBoundPosn < CANVAS_HEIGHT)
            protagonist.moveDown();
    }
    // left arrow
    if (event.key === "ArrowLeft") {
        if (leftBoundPosn > 0)
            protagonist.moveLeft();
    }
    // right arrow
    if (event.key === "ArrowRight") {
        if (rightBoundPosn < CANVAS_WIDTH)
            protagonist.moveRight();
    }
    // home
    if (event.key === "Home") {
        protagonist.entity.moveTo(protagonist.initX, protagonist.initY);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi9zcmMvc2NyaXB0cy9pbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsWUFBWSxFQUFFLGFBQWEsRUFBRSxLQUFLLEVBQUUsV0FBVyxFQUFFLE1BQU0sV0FBVyxDQUFDO0FBRTVFLDJEQUEyRDtBQUMzRCxNQUFNLFdBQVcsR0FBRyxJQUFJLFdBQVcsRUFBRSxDQUFDO0FBRXRDLE1BQU0sTUFBTSxHQUFZLEVBQUUsQ0FBQztBQUMzQixNQUFNLFVBQVUsR0FBRyxFQUFFLENBQUM7QUFDdEIsTUFBTSxVQUFVLEdBQUcsR0FBRyxDQUFDO0FBRXZCLDRDQUE0QztBQUM1QyxNQUFNLGFBQWEsR0FBRyxXQUFXLENBQUMsR0FBRyxFQUFFO0lBQ3JDLHFFQUFxRTtJQUNyRSxJQUFJLE1BQU0sQ0FBQyxNQUFNLEdBQUcsVUFBVSxFQUFFLENBQUM7UUFDL0IsTUFBTSxRQUFRLEdBQUcsSUFBSSxLQUFLLEVBQUUsQ0FBQztRQUM3QixNQUFNLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ3hCLENBQUM7SUFFRCwwQ0FBMEM7SUFDMUMsTUFBTSxpQkFBaUIsR0FBRyxDQUFDLElBQUksRUFBRSxLQUFLLENBQUMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBRXZFLDZFQUE2RTtJQUM3RSxJQUFJLGlCQUFpQixJQUFJLE1BQU0sQ0FBQyxNQUFNLEdBQUcsVUFBVSxFQUFFLENBQUM7UUFDcEQsTUFBTSxXQUFXLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzlELE1BQU0sYUFBYSxHQUFHLE1BQU0sQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUMxQyxhQUFhLENBQUMsTUFBTSxDQUFDLE1B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